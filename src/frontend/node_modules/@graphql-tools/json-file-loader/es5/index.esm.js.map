{"version":3,"file":"index.esm.js","sources":["../../../dist-es5/loaders/json-file/src/index.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { parseGraphQLJSON, isValidPath, } from '@graphql-tools/utils';\nimport { isAbsolute, resolve } from 'path';\nimport { readFile, readFileSync, pathExists, pathExistsSync } from 'fs-extra';\nimport { cwd } from 'process';\nvar FILE_EXTENSIONS = ['.json'];\n/**\n * This loader loads documents and type definitions from JSON files.\n *\n * The JSON file can be the result of an introspection query made against a schema:\n *\n * ```js\n * const schema = await loadSchema('schema-introspection.json', {\n *   loaders: [\n *     new JsonFileLoader()\n *   ]\n * });\n * ```\n *\n * Or it can be a `DocumentNode` object representing a GraphQL document or type definitions:\n *\n * ```js\n * const documents = await loadDocuments('queries/*.json', {\n *   loaders: [\n *     new GraphQLFileLoader()\n *   ]\n * });\n * ```\n */\nvar JsonFileLoader = /** @class */ (function () {\n    function JsonFileLoader() {\n    }\n    JsonFileLoader.prototype.loaderId = function () {\n        return 'json-file';\n    };\n    JsonFileLoader.prototype.canLoad = function (pointer, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var normalizedFilePath;\n            return __generator(this, function (_a) {\n                if (isValidPath(pointer)) {\n                    if (FILE_EXTENSIONS.find(function (extension) { return pointer.endsWith(extension); })) {\n                        normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || cwd(), pointer);\n                        return [2 /*return*/, pathExists(normalizedFilePath)];\n                    }\n                }\n                return [2 /*return*/, false];\n            });\n        });\n    };\n    JsonFileLoader.prototype.canLoadSync = function (pointer, options) {\n        if (isValidPath(pointer)) {\n            if (FILE_EXTENSIONS.find(function (extension) { return pointer.endsWith(extension); })) {\n                var normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || cwd(), pointer);\n                return pathExistsSync(normalizedFilePath);\n            }\n        }\n        return false;\n    };\n    JsonFileLoader.prototype.load = function (pointer, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var normalizedFilePath, jsonContent, e_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        normalizedFilePath = isAbsolute(pointer) ? pointer : resolve(options.cwd || cwd(), pointer);\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, readFile(normalizedFilePath, { encoding: 'utf8' })];\n                    case 2:\n                        jsonContent = _a.sent();\n                        return [2 /*return*/, parseGraphQLJSON(pointer, jsonContent, options)];\n                    case 3:\n                        e_1 = _a.sent();\n                        throw new Error(\"Unable to read JSON file: \" + normalizedFilePath + \": \" + (e_1.message || /* istanbul ignore next */ e_1));\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    JsonFileLoader.prototype.loadSync = function (pointer, options) {\n        var normalizedFilepath = isAbsolute(pointer) ? pointer : resolve(options.cwd || cwd(), pointer);\n        try {\n            var jsonContent = readFileSync(normalizedFilepath, 'utf8');\n            return parseGraphQLJSON(pointer, jsonContent, options);\n        }\n        catch (e) {\n            throw new Error(\"Unable to read JSON file: \" + normalizedFilepath + \": \" + (e.message || /* istanbul ignore next */ e));\n        }\n    };\n    return JsonFileLoader;\n}());\nexport { JsonFileLoader };\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}