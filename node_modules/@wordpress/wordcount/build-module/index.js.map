{"version":3,"sources":["@wordpress/wordcount/src/index.js"],"names":["extend","flow","defaultSettings","stripTags","transposeAstralsToCountableChar","stripHTMLEntities","stripConnectors","stripRemovables","stripHTMLComments","stripShortcodes","stripSpaces","transposeHTMLEntitiesToCountableChars","loadSettings","type","userSettings","settings","shortcodes","l10n","length","shortcodesRegExp","RegExp","join","matchWords","text","regex","bind","match","matchCharacters","count","matchRegExp","results"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { extend, flow } from 'lodash';\n\n/**\n * Internal dependencies\n */\nimport { defaultSettings } from './defaultSettings';\nimport stripTags from './stripTags';\nimport transposeAstralsToCountableChar from './transposeAstralsToCountableChar';\nimport stripHTMLEntities from './stripHTMLEntities';\nimport stripConnectors from './stripConnectors';\nimport stripRemovables from './stripRemovables';\nimport stripHTMLComments from './stripHTMLComments';\nimport stripShortcodes from './stripShortcodes';\nimport stripSpaces from './stripSpaces';\nimport transposeHTMLEntitiesToCountableChars from './transposeHTMLEntitiesToCountableChars';\n\n/**\n * Private function to manage the settings.\n *\n * @param {string} type         The type of count to be done.\n * @param {Object} userSettings Custom settings for the count.\n *\n * @return {void|Object|*} The combined settings object to be used.\n */\nfunction loadSettings( type, userSettings ) {\n\tconst settings = extend( defaultSettings, userSettings );\n\n\tsettings.shortcodes = settings.l10n.shortcodes || {};\n\n\tif ( settings.shortcodes && settings.shortcodes.length ) {\n\t\tsettings.shortcodesRegExp = new RegExp(\n\t\t\t'\\\\[\\\\/?(?:' + settings.shortcodes.join( '|' ) + ')[^\\\\]]*?\\\\]',\n\t\t\t'g'\n\t\t);\n\t}\n\n\tsettings.type = type || settings.l10n.type;\n\n\tif (\n\t\tsettings.type !== 'characters_excluding_spaces' &&\n\t\tsettings.type !== 'characters_including_spaces'\n\t) {\n\t\tsettings.type = 'words';\n\t}\n\n\treturn settings;\n}\n\n/**\n * Match the regex for the type 'words'\n *\n * @param {string} text     The text being processed\n * @param {string} regex    The regular expression pattern being matched\n * @param {Object} settings Settings object containing regular expressions for each strip function\n *\n * @return {Array|{index: number, input: string}} The matched string.\n */\nfunction matchWords( text, regex, settings ) {\n\ttext = flow(\n\t\tstripTags.bind( this, settings ),\n\t\tstripHTMLComments.bind( this, settings ),\n\t\tstripShortcodes.bind( this, settings ),\n\t\tstripSpaces.bind( this, settings ),\n\t\tstripHTMLEntities.bind( this, settings ),\n\t\tstripConnectors.bind( this, settings ),\n\t\tstripRemovables.bind( this, settings )\n\t)( text );\n\ttext = text + '\\n';\n\treturn text.match( regex );\n}\n\n/**\n * Match the regex for either 'characters_excluding_spaces' or 'characters_including_spaces'\n *\n * @param {string} text     The text being processed\n * @param {string} regex    The regular expression pattern being matched\n * @param {Object} settings Settings object containing regular expressions for each strip function\n *\n * @return {Array|{index: number, input: string}} The matched string.\n */\nfunction matchCharacters( text, regex, settings ) {\n\ttext = flow(\n\t\tstripTags.bind( this, settings ),\n\t\tstripHTMLComments.bind( this, settings ),\n\t\tstripShortcodes.bind( this, settings ),\n\t\tstripSpaces.bind( this, settings ),\n\t\ttransposeAstralsToCountableChar.bind( this, settings ),\n\t\ttransposeHTMLEntitiesToCountableChars.bind( this, settings )\n\t)( text );\n\ttext = text + '\\n';\n\treturn text.match( regex );\n}\n\n/**\n * Count some words.\n *\n * @param {string} text         The text being processed\n * @param {string} type         The type of count. Accepts ;words', 'characters_excluding_spaces', or 'characters_including_spaces'.\n * @param {Object} userSettings Custom settings object.\n *\n * @example\n * ```js\n * import { count } from '@wordpress/wordcount';\n * const numberOfWords = count( 'Words to count', 'words', {} )\n * ```\n *\n * @return {number} The word or character count.\n */\n\nexport function count( text, type, userSettings ) {\n\tif ( '' === text ) {\n\t\treturn 0;\n\t}\n\n\tif ( text ) {\n\t\tconst settings = loadSettings( type, userSettings );\n\t\tconst matchRegExp = settings[ type + 'RegExp' ];\n\t\tconst results =\n\t\t\t'words' === settings.type\n\t\t\t\t? matchWords( text, matchRegExp, settings )\n\t\t\t\t: matchCharacters( text, matchRegExp, settings );\n\n\t\treturn results ? results.length : 0;\n\t}\n}\n"]}