version: 2.1
jobs:
  build:
    working_directory: ~/telescope
    docker:
      - image: circleci/node:lts
      - image: circleci/redis:latest 
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: npm ci
      - run:
          name: Execute tests
          command: npm test

  buildmacos:
    working_directory: ~/telescope
    executor:
      macos:
        xcode: "9.0"
    
    docker:
      - image: circleci/node:lts
      - image: circleci/redis:latest 
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: npm ci
      - run:
          name: Execute tests
          command: npm test
  
 # build-windows:
  #  working_directory: ~/telescope
  #  executor:
   #   name: win/vs2019
   #   shell: bash.exe
   # docker:
   #   - image: circleci/node:lts
    #  - image: circleci/redis:latest 
  #  steps:
  #    - checkout
  #    - run:
  #        name: Install dependencies
  #        command: npm ci
   #   - run:
   #       name: Execute tests
   #       command: npm test
          
workflows:
  version: 2.1
  build:
    jobs:
      - "build"
      - "buildmacos"
    #  - "build-windows"